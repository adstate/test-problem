(this["webpackJsonptest-problem"]=this["webpackJsonptest-problem"]||[]).push([[0],{69:function(e,t,n){},70:function(e,t,n){},79:function(e,t,n){"use strict";n.r(t);var a,c=n(0),r=n.n(c),i=n(15),d=n.n(i),l=(n(69),n(6)),o=(n(70),n(7)),b=n(11),u=n(103),s=n(101),j=n(42),O=n.n(j),p=n(43),f=n.n(p),x=n(104);!function(e){e.New="NEW",e.Changed="CHANGED",e.Deleted="DELETED",e.Origin="ORIGIN"}(a||(a={}));var h=a,v=n(80),g=n(56),y=n.n(g),m=n(23),C=n(3),I="MOVE_NODE",E="ADD_NODE",k="CHANGE_NODE",N="DELETE_NODE",D="CLEAR_CACHE",w="SET_CACHE",A=function(e,t){return function(n,a){var c=a().cache.table[e];if(c){var r=Object(C.a)(Object(C.a)({},c),{},{value:t,state:c.state===h.New?h.New:h.Changed});n(function(e,t){return{type:k,payload:{id:e,node:t}}}(e,r))}}},T=function(e,t){return function(n,a){var c=a().cache.sequence,r=c.prefix+c.next,i={id:r,parentId:e,value:t,state:h.New};n({type:E,payload:{id:r,node:i}})}},S=function(e,t){return Object.values(t).filter((function(t){return t.parentId===e}))||[]},_=function(e){return function(t,n){var a=n().cache.table,c=n().cache.table[e],r={};c.state===h.New?delete a[e]:r[e]=Object(C.a)(Object(C.a)({},c),{},{state:h.Deleted});for(var i=S(e,a),d=function(){var e=[];i.forEach((function(t){t.state===h.New?delete a[t.id]:r[t.id]=Object(C.a)(Object(C.a)({},t),{},{state:h.Deleted}),e.push.apply(e,Object(m.a)(S(t.id,a)))})),i=e};i.length>0;)d();t({type:N,payload:{nodes:r}})}},M="APPLY_CHANGES",B="SET_SEQUENCE",q="RESET_DATABASE",L="UPDATE_INDEX";function P(e){for(var t=[],n={},a=new Set,c=0,r=Object.values(e);c<r.length;c++){var i=r[c],d=i.id,l=i.parentId;Object.prototype.hasOwnProperty.call(n,d)||(n[d]={children:[]}),a.has(d)&&a.delete(d),n[d]=Object(C.a)(Object(C.a)({},i),{},{children:n[d].children});var o=n[d];l?(Object.prototype.hasOwnProperty.call(n,l)||(n[l]={children:[]},a.add(l)),n[l].children.push(o)):t.push(o)}if(a.size>0)for(var b=0,u=Array.from(a);b<u.length;b++){var s=u[b];t.push.apply(t,Object(m.a)(n[s].children))}return t}function z(e){for(var t={},n=0,a=Object.values(e);n<a.length;n++){var c=a[n];t[c.id]||(t[c.id]=[]),c.parentId&&t[c.parentId]&&t[c.parentId].push(c.id)}return t}var H,F,G,R,J,K,U,W,Q,V,X,Y,Z,$,ee,te,ne,ae,ce,re,ie=function(e){return function(t,n){var a=n().database.table,c=n().cache.table,r=a[e];r&&!c[e]&&r.state!==h.Deleted&&t(function(e){return{type:I,payload:e}}(Object(C.a)(Object(C.a)({},r),{},{state:h.Origin})))}},de=function(){return function(e,t){for(var n=t().cache.table,a=t().database.table,c=t().database.sequence,r=t().database.index,i=c.next,d={},l={},o={},b=0,u=Object.values(n);b<u.length;b++){var s=u[b];if(s.state===h.New){var j=String(i),O=s.parentId&&o[s.parentId]?o[s.parentId]:s.parentId;d[j]={id:j,parentId:O,value:s.value,state:h.Origin},o[s.id]=j,i+=1}else if(s.state===h.Changed)d[s.id]=Object(C.a)(Object(C.a)({},s),{},{value:s.value,state:h.Origin});else if(s.state===h.Deleted){d[s.id]=Object(C.a)(Object(C.a)({},s),{},{state:h.Deleted});for(var p=r[s.id],f=function(){var e=[];p.forEach((function(t){l[t]=Object(C.a)(Object(C.a)({},a[t]),{},{state:h.Deleted}),e.push.apply(e,Object(m.a)(r[t]))})),p=e};p.length>0;)f()}else s.state===h.Origin&&(d[s.id]=s)}if(Object.keys(d).length>0){e(function(e){return{type:M,payload:{changes:e}}}(Object(C.a)(Object(C.a)({},d),l)));var x=z(t().database.table);e({type:L,payload:{index:x}}),e({type:w,payload:{table:d}})}c.next!==i&&e({type:B,payload:{next:i}})}},le=function(){return function(e){e({type:q}),e({type:D})}},oe=n(2),be=o.a.div(H||(H=Object(l.a)(["\n    display: flex;\n    align-items: center;\n"]))),ue=o.a.div(F||(F=Object(l.a)(["\n    padding: 40px;\n"]))),se=o.a.div(G||(G=Object(l.a)(["\n    width: 250px;\n    height: 300px;\n    border: 1px solid #c0c0c0;\n    border-radius: 2px;\n    padding: 10px;\n    overflow-y: auto;\n"]))),je=Object(o.a)(x.a)(R||(R=Object(l.a)(["\n  ","\n"])),(function(e){return e.state===h.Deleted&&"\n    color: #c0c0c0;\n\n    & div.MuiTreeItem-label:hover {\n      background-color: #fff;\n    }\n\n    & div.MuiTreeItem-label {\n      background-color: #fff !important;\n      cursor: default;\n    }\n  "})),Oe="",pe=function(e){var t=e.dbTree,n=Object(b.b)(),a=Object(c.useCallback)((function(e){e.preventDefault()}),[]),r=Object(c.useCallback)((function(){Oe&&n(ie(Oe))}),[n]);return Object(oe.jsxs)(be,{children:[Object(oe.jsx)(ue,{children:Object(oe.jsx)(v.a,{variant:"contained",onClick:r,children:Object(oe.jsx)(y.a,{})})}),Object(oe.jsx)(se,{children:t&&Object(oe.jsx)(s.a,{defaultCollapseIcon:Object(oe.jsx)(O.a,{}),defaultExpanded:["1","2","3","4","5"],defaultExpandIcon:Object(oe.jsx)(f.a,{}),onNodeSelect:function(e,t){var n=e.target.closest(".MuiTreeItem-root").getAttribute("state");Oe=n===h.Deleted?"":t},children:function e(t){return Object(oe.jsx)(je,{state:t.state,nodeId:t.id,label:t.value,onLabelClick:a,children:Array.isArray(t.children)&&t.children.map((function(t){return e(t)}))},t.id)}(t)})})]})},fe=r.a.memo(pe),xe=n(33),he=n(102),ve=n(105),ge=o.a.div(J||(J=Object(l.a)(["\n    position: absolute;\n    top: 0;\n    right: 0;\n    display: flex;\n    justify-content: center;\n    background-color: #fff;\n    height: 100%;\n    padding: 20px;\n    width: 400px;\n    border-top-right-radius: 4px;\n    border-bottom-right-radius: 4px;\n    z-index: 2;\n"]))),ye=o.a.div(K||(K=Object(l.a)(["\n    width: 300px;\n"]))),me=o.a.h4(U||(U=Object(l.a)(["\n    margin-top: 5px;\n    margin-bottom: 25px;\n"]))),Ce=o.a.div(W||(W=Object(l.a)(["\n    display: flex;\n    justify-content: flex-end;\n    padding: 10px 0;\n    margin-top: 25px;\n\n    & .MuiButtonBase-root {\n        margin-right: 8px;\n    }\n"]))),Ie=function(e){var t=e.nodeId,n=e.parentId,a=e.onSave,c=e.onClose,i=Object(b.c)((function(e){return t?e.cache.table[t]:null})),d=Object(b.c)((function(e){return n?e.cache.table[n]:null})),l=r.a.useState(""),o=Object(xe.a)(l,2),u=o[0],s=o[1];r.a.useEffect((function(){i&&s(i.value)}),[i]);return Object(oe.jsx)(ge,{children:Object(oe.jsxs)(ye,{children:[i?Object(oe.jsxs)(me,{children:["Edit ",i.value]}):Object(oe.jsxs)(me,{children:["Add child node for ",d&&d.value]}),Object(oe.jsxs)("form",{onSubmit:function(){i?a(i.id,u):n&&a(n,u)},children:[Object(oe.jsx)("div",{children:Object(oe.jsx)(ve.a,{fullWidth:!0,value:u,onChange:function(e){s(e.target.value)}})}),Object(oe.jsxs)(Ce,{children:[Object(oe.jsx)(v.a,{onClick:c,children:"Cancel"}),Object(oe.jsx)(v.a,{type:"submit",variant:"contained",disabled:!u,children:"OK"})]})]})]})})},Ee=o.a.div(Q||(Q=Object(l.a)(["\n    position: absolute;\n    top: 0;\n    right: 0;\n    display: flex;\n    justify-content: center;\n    background-color: #fff;\n    height: 100%;\n    padding: 20px;\n    width: 400px;\n    border-top-right-radius: 4px;\n    border-bottom-right-radius: 4px;\n    z-index: 2;\n"]))),ke=o.a.div(V||(V=Object(l.a)(["\n    width: 300px;\n"]))),Ne=function(e){var t=e.children;return Object(oe.jsx)(Ee,{children:Object(oe.jsx)(ke,{children:t})})},De=o.a.h4(X||(X=Object(l.a)(["\n    margin-top: 5px;\n    margin-bottom: 25px;\n"]))),we=o.a.div(Y||(Y=Object(l.a)(["\n    display: flex;\n    justify-content: flex-end;\n    padding: 10px 0;\n    margin-top: 25px;\n\n    & .MuiButtonBase-root {\n        margin-right: 8px;\n    }\n"]))),Ae=function(e){var t=e.nodeId,n=e.onDelete,a=e.onClose,c=Object(b.c)((function(e){return e.cache.table[t]}));return Object(oe.jsxs)(Ne,{children:[Object(oe.jsxs)(De,{children:["Delete ",c.value]}),Object(oe.jsx)("div",{children:"Node will be mark as deleted. Are you sure?"}),Object(oe.jsxs)(we,{children:[Object(oe.jsx)(v.a,{onClick:a,children:"Cancel"}),Object(oe.jsx)(v.a,{variant:"contained",onClick:function(){n(c.id)},children:"OK"})]})]})},Te=o.a.div(Z||(Z=Object(l.a)(["\n  display: flex;\n  flex-direction: column;\n  height: 300px;\n  border: 1px solid #c0c0c0;\n  border-radius: 2px;\n"]))),Se=o.a.div($||($=Object(l.a)(["\n  flex: 1;\n  width: 250px;\n  height: 250px;\n  padding: 10px;\n  overflow-y: auto;\n"]))),_e=o.a.div(ee||(ee=Object(l.a)(["\n  display: flex;\n  justify-content: center;\n  padding: 5px;\n"]))),Me=Object(o.a)(x.a)(te||(te=Object(l.a)(["\n  ","\n\n  ","\n\n  ","\n"])),(function(e){return e.state===h.Deleted&&"\n    color: #c0c0c0;\n\n    & div.MuiTreeItem-label:hover {\n      background-color: #fff;\n    }\n\n    & div.MuiTreeItem-label {\n      background-color: #fff !important;\n      cursor: default;\n    }\n  "}),(function(e){return e.state===h.New&&"\n    color: green;\n  "}),(function(e){return e.state===h.Changed&&"\n    color: orange;\n  "})),Be="",qe=function(e){var t=e.cacheTree,n=e.expanded,a=Object(b.b)(),i=r.a.useState([]),d=Object(xe.a)(i,2),l=d[0],o=d[1],u=r.a.useState(""),j=Object(xe.a)(u,2),p=j[0],x=j[1];r.a.useEffect((function(){o(n),Be=""}),[n]);var g=Object(c.useCallback)((function(e){e.preventDefault()}),[]),y=Object(c.useCallback)((function(){x("edit")}),[]),m=Object(c.useCallback)((function(){x("add")}),[]),C=Object(c.useCallback)((function(){x("delete")}),[]),I=Object(c.useCallback)((function(){x("")}),[]),E=Object(c.useCallback)((function(e,t){a(A(e,t)),x("")}),[a]),k=Object(c.useCallback)((function(e,t){a(T(e,t)),x("")}),[a]),N=Object(c.useCallback)((function(e){a(_(e)),x("")}),[a]),D=function e(t){return Object(oe.jsx)(Me,{state:t.state,nodeId:t.id,label:t.value,onLabelClick:g,children:Array.isArray(t.children)&&t.children.map((function(t){return e(t)}))},t.id)};return Object(oe.jsxs)("div",{children:[Object(oe.jsxs)(Te,{children:[Object(oe.jsx)(Se,{children:t&&Object(oe.jsx)(s.a,{defaultCollapseIcon:Object(oe.jsx)(O.a,{}),expanded:l,defaultExpandIcon:Object(oe.jsx)(f.a,{}),onNodeSelect:function(e,t){var n=e.target.closest(".MuiTreeItem-root").getAttribute("state");Be=n===h.Deleted?"":t,x("")},onNodeToggle:function(e,t){o(t)},children:t.map((function(e){return D(e)}))})}),Object(oe.jsx)(_e,{children:Object(oe.jsxs)(he.a,{color:"primary",children:[Object(oe.jsx)(v.a,{size:"small",onClick:y,children:"edit"}),Object(oe.jsx)(v.a,{size:"small",onClick:m,children:"add"}),Object(oe.jsx)(v.a,{size:"small",onClick:C,children:"delete"})]})})]}),"edit"===p&&Be&&Object(oe.jsx)(Ie,{nodeId:Be,onSave:E,onClose:I}),"add"===p&&Be&&Object(oe.jsx)(Ie,{parentId:Be,onSave:k,onClose:I}),"delete"===p&&Be&&Object(oe.jsx)(Ae,{nodeId:Be,onDelete:N,onClose:I})]})},Le=n(45),Pe=function(e){return e.cache.table},ze=Object(Le.a)(Pe,(function(e){return P(e)})),He=Object(Le.a)((function(e){return e.database.table}),(function(e){return P(e)[0]})),Fe=Object(Le.a)(Pe,(function(e){return Object.keys(e)})),Ge=Object(o.a)(u.a)(ne||(ne=Object(l.a)(["\n    position: relative;\n"]))),Re=o.a.div(ae||(ae=Object(l.a)(["\n    display: flex;\n    justify-content: space-between;    \n    padding: 25px;\n    align-items: center;\n"]))),Je=o.a.div(ce||(ce=Object(l.a)(["\n    display: flex;\n    justify-content: flex-end;\n    padding: 0 25px 25px 25px;\n\n    & .MuiButtonBase-root {\n        margin-left: 10px;\n    }\n"]))),Ke=r.a.memo((function(){var e=Object(b.b)(),t=Object(b.c)(He),n=Object(b.c)(ze),a=Object(b.c)(Fe);return Object(oe.jsxs)(Ge,{children:[Object(oe.jsxs)(Re,{children:[Object(oe.jsx)(qe,{cacheTree:n,expanded:a}),Object(oe.jsx)(fe,{dbTree:t})]}),Object(oe.jsxs)(Je,{children:[Object(oe.jsx)(v.a,{onClick:function(){e(le())},children:"Reset"}),Object(oe.jsx)(v.a,{variant:"contained",onClick:function(){e(de())},children:"Apply"})]})]})})),Ue=o.a.div(re||(re=Object(l.a)(["\n  margin: 50px auto 0;\n  min-width: 600px;\n  max-width: 700px;\n"])));var We=function(){return Object(oe.jsx)(Ue,{children:Object(oe.jsx)(Ke,{})})},Qe=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,107)).then((function(t){var n=t.getCLS,a=t.getFID,c=t.getFCP,r=t.getLCP,i=t.getTTFB;n(e),a(e),c(e),r(e),i(e)}))},Ve=n(20),Xe=n(57),Ye=n(25),Ze={table:{},sequence:{prefix:"node_",next:1}};var $e={1:{id:"1",parentId:null,value:"Node1",state:h.Origin},2:{id:"2",parentId:"1",value:"Node2",state:h.Origin},3:{id:"3",parentId:"1",value:"Node3",state:h.Origin},4:{id:"4",parentId:"2",value:"Node4",state:h.Origin},5:{id:"5",parentId:"2",value:"Node5",state:h.Origin},6:{id:"6",parentId:"3",value:"Node6",state:h.Origin},7:{id:"7",parentId:"3",value:"Node7",state:h.Origin},8:{id:"8",parentId:"6",value:"Node8",state:h.Origin},9:{id:"9",parentId:"4",value:"Node9",state:h.Origin}},et={table:$e,index:z($e),sequence:{next:10}};var tt=Object(Ve.c)({cache:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ze,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case I:return Object(C.a)(Object(C.a)({},e),{},{table:Object(C.a)(Object(C.a)({},e.table),{},Object(Ye.a)({},t.payload.id,t.payload))});case k:return Object(C.a)(Object(C.a)({},e),{},{table:Object(C.a)(Object(C.a)({},e.table),{},Object(Ye.a)({},t.payload.id,t.payload.node))});case E:return Object(C.a)(Object(C.a)({},e),{},{table:Object(C.a)(Object(C.a)({},e.table),{},Object(Ye.a)({},t.payload.id,t.payload.node)),sequence:Object(C.a)(Object(C.a)({},e.sequence),{},{next:e.sequence.next+1})});case N:return Object(C.a)(Object(C.a)({},e),{},{table:Object(C.a)(Object(C.a)({},e.table),t.payload.nodes)});case w:return Object(C.a)(Object(C.a)({},e),{},{table:t.payload.table});case D:return Ze;default:return e}},database:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:et,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case M:return Object(C.a)(Object(C.a)({},e),{},{table:Object(C.a)(Object(C.a)({},e.table),t.payload.changes)});case L:return Object(C.a)(Object(C.a)({},e),{},{index:t.payload.index});case B:return Object(C.a)(Object(C.a)({},e),{},{sequence:{next:t.payload.next}});case q:return et;default:return e}}}),nt=[Xe.a],at=Object(Ve.d)(tt,{},Ve.a.apply(void 0,nt));d.a.render(Object(oe.jsx)(b.a,{store:at,children:Object(oe.jsx)(We,{})}),document.getElementById("root")),Qe()}},[[79,1,2]]]);
//# sourceMappingURL=main.57170150.chunk.js.map